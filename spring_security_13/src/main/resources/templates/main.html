<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<meta charset="UTF-8">
<title>Products</title>
</head>
<body>
	<h2 th:text="'Hello, ' + ${username} + '!'"></h2>
	<h2 th:text="'Role ' + ${role}"></h2>
	
	<p><a href="/logout">Sign out here</a></p>
	
	<div sec:authorize="!hasAnyAuthority('READER','CREATOR')">
		<p>Non autorizzato alla visualizzazione dei dati</p>
	</div>

	<div sec:authorize="hasAuthority('CREATOR')">
		<form action="/product/add" method="post">
			<span>Name:</span> 
			<span><input type="text" name="name" /></span> 
			<span><button type="submit">Add</button></span> 
		    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
		</form>
	</div>

	<div sec:authorize="hasAnyAuthority('READER','CREATOR')">
		<h2>These are all the products:</h2>
		<table>
			<thead>
				<tr>
					<th>Name</th>
					<th>Price</th>
				</tr>
			</thead>
			<tbody>
				<tr th:if="${products.empty}">
					<td colspan="2">No Products Available</td>
				</tr>
				<tr th:each="book : ${products}">
					<td><span th:text="${book.name}"> Name </span></td>
					<td><span th:text="${book.price}"> Price </span></td>
				</tr>
			</tbody>
		</table>
	</div>
</body>
</html>